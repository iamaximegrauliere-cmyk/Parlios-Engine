name: green.alert
on:
  workflow_run:
    workflows: ['Parlios-Engine CI']
    types: [completed]
permissions: { contents: read, issues: write }
jobs:
  green:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Upsert issue 'Parlios-Engine CI ✅ Build vert'
        uses: actions/github-script@v7
        with:
          script: |
            const TITLE = "Parlios-Engine CI ✅ Build vert";
            const body = `Run: ${{ github.event.workflow_run.html_url }}`;
            const { data: issues } = await github.rest.issues.listForRepo({owner: context.repo.owner, repo: context.repo.repo, state:"open", per_page:100});
            const existing = issues.find(i => i.title === TITLE);
            if (existing) { await github.rest.issues.update({owner: context.repo.owner, repo: context.repo.repo, issue_number: existing.number, body}); }
            else { await github.rest.issues.create({owner: context.repo.owner, repo: context.repo.repo, title: TITLE, body}); }
